---
title: Payload Structure
---

# Webhook Payload Structure

All Cloud66 webhooks follow a consistent JSON payload structure with common fields and event-specific data.

## Common Fields

Every webhook payload includes these standard fields:

<TypedProperty name="timestamp" type="integer" example="1640995200" />
When the event occurred, in UTC as a Unix timestamp.

<TypedProperty name="event_type" type="string" example="stack.provision.ok" />
Identifies the specific event that triggered the webhook. Format: `category.action.status` (e.g., `server.stopped`, `payment.fail`)

## Event-Specific Data

Beyond the common fields, each webhook includes relevant model data specific to the event type. This data follows the same structure used by the Cloud66 API.

### Stack Events
Stack-related webhooks include complete stack information:

```json
{
  "timestamp": 1640995200,
  "event_type": "stack.provision.ok",
  "uid": "abc123def456",
  "name": "My Application",
  "git": "https://github.com/user/repo.git",
  "git_branch": "master",
  "environment": "production",
  "cloud": "aws",
  "fqdn": "my-app.c66.me",
  "language": "ruby",
  "framework": "rails",
  "status": 1,
  "health": 3,
  "created_at": "2024-01-01T10:00:00Z",
  "updated_at": "2024-01-01T12:30:45Z",
  "deploy_context": {
    "triggered_by": "user@example.com",
    "outcome": "success",
    "started_at": "2024-01-01T12:00:00Z",
    "finished_at": "2024-01-01T12:30:45Z"
  }
}
```

### Server Events
Server-related webhooks include server and agent information:

```json
{
  "timestamp": 1640995200,
  "event_type": "server.stopped",
  "uid": "123123123123123123",
  "name": "Meerkat",
  "address": "192.168.1.10",
  "server_type": "Rails Server",
  "server_roles": ["rails", "web"],
  "region": "us-east-1",
  "size": "m5.large",
  "created_at": "2024-01-01T10:00:00Z",
  "updated_at": "2024-01-01T12:30:45Z"
}
```

### Container Events
Container events include detailed container information:

```json
{
  "timestamp": 1640995200,
  "event_type": "container.down",
  "container_id": "abc123def456789...",
  "name": "web.container-name",
  "service_name": "web",
  "image": "nginx:latest",
  "ports": [
    {
      "container": 80,
      "http": 80,
      "https": 443
    }
  ],
  "health_state": "unhealthy",
  "private_ip": "10.0.1.15",
  "created_at": "2024-01-01T10:00:00Z"
}
```

## Data Consistency

Webhook payloads use the same data structures and field names as the Cloud66 API endpoints. This ensures consistency across all integrations:

- **Stack data**: Matches [GET /stacks/:id](/v3/endpoints/stacks/get) response
- **Server data**: Matches [GET /stacks/:id/servers](/v3/endpoints/servers/list) response  
- **Container data**: Matches container objects from service endpoints
- **User data**: Matches user objects from account endpoints

## Payload Examples by Category

### Deployment Events
Deployment-related events include stack data plus deployment context:

```json
{
  "timestamp": 1640995200,
  "event_type": "stack.deploy.started",
  "uid": "abc123def456",
  "name": "My Application",
  "deploy_context": {
    "id": 158,
    "triggered_by": "Cloudia Sixton",
    "triggered_via": "web",
    "git_hash": "abc123def456...",
    "deploy_type": "build",
    "is_head": true
  }
}
```

### Security Events
Security events include relevant security-related data:

```json
{
  "timestamp": 1640995200,
  "event_type": "ssl_certificate.expire.soon",
  "ssl_certificate": {
    "name": "My SSL Certificate",
    "server_names": "example.com,www.example.com",
    "lets_encrypt": true,
    "cert_expiry": "2024-07-01T00:00:00Z",
    "status": "installed"
  }
}
```

### Account Events
Account events include billing and account information:

```json
{
  "timestamp": 1640995200,
  "event_type": "payment.fail",
  "charged_amount": "$29.00",
  "reason": "Credit card expired"
}
```

## Handling Webhook Payloads

### JSON Processing
All payloads are sent as JSON with `Content-Type: application/json`:

```javascript
// Express.js example
app.post('/webhook', express.json(), (req, res) => {
  const webhook = req.body;
  const eventType = webhook.event_type;
  const timestamp = new Date(webhook.timestamp * 1000);
  
  // Process based on event type
  switch (eventType) {
    case 'stack.provision.ok':
      handleDeploymentSuccess(webhook);
      break;
    case 'server.stopped':
      handleServerDown(webhook);
      break;
    // ... handle other events
  }
  
  res.status(200).send('OK');
});
```

### Event Filtering
Filter events based on the `event_type` field:

```javascript
function routeWebhook(webhook) {
  const [category, action, status] = webhook.event_type.split('.');
  
  if (category === 'stack') {
    handleStackEvent(webhook);
  } else if (category === 'server') {
    handleServerEvent(webhook);
  } else if (category === 'payment') {
    handleBillingEvent(webhook);
  }
}
```

### Data Validation
Validate webhook payloads before processing:

```javascript
function validateWebhook(webhook) {
  // Check required fields
  if (!webhook.timestamp || !webhook.event_type) {
    throw new Error('Missing required webhook fields');
  }
  
  // Validate timestamp (should be recent)
  const age = Date.now() - (webhook.timestamp * 1000);
  if (age > 300000) { // 5 minutes
    throw new Error('Webhook timestamp too old');
  }
  
  return true;
}
```

## Model References

For detailed field descriptions, refer to the model documentation:

- **[Stack](/v3/models/stack)** - Stack-related webhook data
- **[Server](/v3/models/server)** - Server and infrastructure data
- **[Container](/v3/models/container)** - Container and service data
- **[SSL Certificate](/v3/models/ssl-certificate)** - SSL certificate data
- **[User](/v3/models/user)** - User and authentication data
- **[Job](/v3/models/job)** - Scheduled job data
- **[Backup](/v3/models/backup)** - Backup and database data

<Callout type="info" title="Payload Consistency">
Webhook payloads are generated using the same serialization methods as API responses, ensuring data consistency across all Cloud66 integrations.
</Callout>
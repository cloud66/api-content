---
title: Database & Backup Events
---

# Database & Backup Events

Database and backup events are webhooks triggered by backup operations, database replication issues, and backup verification processes.

## Backup Events

### `managed_backup.fail`
Triggered when a managed backup operation fails.

**Payload includes:**
- Stack information
- Backup failure details and error message

```json
{
  "timestamp": 1640995200,
  "event_type": "managed_backup.fail",
  "uid": "abc123def456",
  "name": "My Application",
  "environment": "production",
  "backup_result": "Unable to determine database name on which backup can be restored."
}
```

### `backup.verification.failed`
Triggered when backup verification fails, indicating the backup may be corrupted or incomplete.

**Payload includes:**
- Stack information
- Backup details and verification failure information

```json
{
  "timestamp": 1640995200,
  "event_type": "backup.verification.failed",
  "stack": {
    "uid": "abc123def456",
    "name": "My Application",
    "environment": "production"
  },
  "backup": {
    "id": 42,
    "db_type": "postgresql",
    "database_name": "postgres_production",
    "backup_date": "2024-01-01T12:00:00Z",
    "backup_status": "ok",
    "verify_status": "failed",
    "verify_result": "The result of your verifier script is not as expected: ERROR 1146 (42S02) at line 1: Table 'users' doesn't exist",
    "storage_path": "backups/postgresql/postgres_production/2024.01.01.12.00.00",
    "backup_size": 4274995200,
    "created_at": "2024-01-01T12:00:00Z",
    "updated_at": "2024-01-01T12:30:00Z"
  }
}
```

## Database Replication Events

### `db.slave.ok`
Triggered when database slave replication is functioning correctly after a previous issue.

**Payload includes:**
- Server information for the slave database
- Database type (mysql, postgresql, etc.)

```json
{
  "timestamp": 1640995200,
  "event_type": "db.slave.ok",
  "server": {
    "name": "Meerkat",
    "uid": "123123123123123123",
    "server_type": "MySQL Server",
    "address": "192.168.1.15",
    "created_at": "2024-01-01T10:00:00Z",
    "updated_at": "2024-01-01T12:30:45Z"
  },
  "db_type": "mysql"
}
```

### `db.slave.failed`
Triggered when database slave replication fails or falls behind the master.

**Payload includes:**
- Server information for the slave database
- Database type
- Failure details

```json
{
  "timestamp": 1640995200,
  "event_type": "db.slave.failed",
  "server": {
    "name": "Meerkat",
    "uid": "123123123123123123",
    "server_type": "MySQL Server",
    "address": "192.168.1.15"
  },
  "db_type": "mysql",
  "detail": "No longer is slave"
}
```

## Common Use Cases

### Backup Monitoring
- **Failure Alerts**: Immediate notification when backups fail
- **Verification Tracking**: Monitor backup integrity over time
- **Compliance Reporting**: Maintain records of backup success/failure for audits
- **Automated Recovery**: Trigger backup retry mechanisms or alternative backup strategies

### Database Health Monitoring
- **Replication Monitoring**: Track master-slave database health
- **High Availability**: Trigger failover procedures when slaves fail
- **Performance Tracking**: Monitor replication lag and performance
- **Disaster Recovery**: Coordinate backup and replication monitoring

### Operational Workflows
- **Incident Response**: Escalate database issues to on-call teams
- **Maintenance Planning**: Schedule maintenance based on backup/replication status
- **Capacity Planning**: Track backup sizes and storage requirements
- **Documentation**: Log database events for troubleshooting and analysis

## Event Response Patterns

### Backup Failure Response
```json
{
  "event_type": "managed_backup.fail",
  "backup_result": "Connection timeout"
}
// Possible responses:
// 1. Retry backup after 30 minutes
// 2. Check database server health
// 3. Alert database administrator
// 4. Switch to alternative backup method
```

### Replication Failure Response
```json
{
  "event_type": "db.slave.failed",
  "detail": "Replication lag exceeded threshold"
}
// Possible responses:
// 1. Check network connectivity
// 2. Restart replication process
// 3. Switch read traffic away from slave
// 4. Alert database team for manual intervention
```

## Monitoring Best Practices

### Backup Verification
- Set up regular backup verification schedules
- Test restore procedures periodically
- Monitor backup file sizes for consistency
- Maintain backup retention policies

### Database Replication
- Monitor replication lag metrics
- Set up alerts for slave disconnections
- Test failover procedures regularly
- Maintain slave server health monitoring

<Callout type="warning" title="Critical Database Events">
Database and backup failures can lead to data loss. These events should trigger high-priority alerts and immediate investigation.
</Callout>

<RelatedModels models={['Backup', 'Server', 'Stack']} />
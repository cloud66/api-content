---
title: Security Events
---

# Security Events

Security events are webhooks triggered by SSL certificate operations, authentication activities, and security monitoring systems like Active Protect.

## SSL Certificate Events

### `ssl_certificate.install.ok`
Triggered when an SSL certificate is successfully installed.

**Payload includes:**
- Certificate details (domains, expiry, type)
- Installation status and configuration

```json
{
  "timestamp": 1640995200,
  "event_type": "ssl_certificate.install.ok",
  "ssl_certificate": {
    "stack_id": 123,
    "name": "Awesome SSL Certificate",
    "server_names": "example.com,awesome-example.com",
    "lets_encrypt": true,
    "has_intermediate_cert": true,
    "ssl_termination": true,
    "status": "installed",
    "cert_expiry": "2024-07-01T00:00:00Z",
    "created_at": "2024-01-01T12:30:45Z",
    "updated_at": "2024-01-01T12:35:30Z"
  }
}
```

### `ssl_certificate.install.fail`
Triggered when SSL certificate installation fails.

**Payload structure:** Same as `ssl_certificate.install.ok` but with status indicating failure and error details.

### `ssl_certificate.expire.soon`
Triggered when an SSL certificate is approaching expiration (typically 30 days before).

**Payload includes:**
- Certificate details with expiry information
- Domains that will be affected

## Authentication Events

### `app.auth`
Triggered when an OAuth application is authorized to access your Cloud66 account.

**Payload includes:**
- User information
- Application identifier

```json
{
  "timestamp": 1640995200,
  "event_type": "app.auth",
  "user": "user@example.com",
  "app": "7c2c4ab2ae7ed4c33c3dacd1e9715f796ec222fd8985341128d7f7d485349caf"
}
```

### `app.deauth`
Triggered when an OAuth application authorization is revoked.

**Payload structure:** Same as `app.auth` but indicates deauthorization.

## Active Protect Events

Active Protect is Cloud66's intrusion detection and prevention system that monitors your servers for security threats.

### `active.protect.block`
Triggered when Active Protect blocks an IP address due to suspicious activity.

**Payload includes:**
- Server information where the block occurred
- Details about the blocked activity

```json
{
  "timestamp": 1640995200,
  "event_type": "active.protect.block",
  "server": {
    "name": "Meerkat",
    "uid": "123123123123123123",
    "server_type": "MySQL Server"
  },
  "fail2ban_action": {
    "action_date": "2024-01-01T12:30:45Z",
    "banned": true,
    "address": "1.2.3.4",
    "attack": "SSH",
    "country": "Thailand",
    "country_code": "th",
    "port": 22,
    "created_at": "2024-01-01T12:30:45Z"
  }
}
```

### `active.protect.change`
Triggered when Active Protect detects unauthorized file changes on your servers.

**Payload includes:**
- Server information
- File change details

```json
{
  "timestamp": 1640995200,
  "event_type": "active.protect.change",
  "server": {
    "name": "Meerkat",
    "uid": "123123123123123123"
  },
  "watched_file": {
    "file_path": "/tmp/important-config",
    "existing_file_hash": "234234234",
    "new_file_hash": "123123123",
    "created_at": "2024-01-01T12:30:45Z",
    "updated_at": "2024-01-01T12:30:45Z"
  }
}
```

## Access Events

### `ssh_key.downloaded`
Triggered when someone downloads SSH keys for server access.

**Payload includes:**
- Stack and server information
- User who downloaded the keys

```json
{
  "timestamp": 1640995200,
  "event_type": "ssh_key.downloaded",
  "uid": "abc123def456",
  "name": "My Application",
  "server": "Meerkat",
  "user_email": "user@example.com"
}
```

## Common Use Cases

### SSL Management
- **Expiry Alerts**: Get notified before certificates expire to avoid downtime
- **Installation Monitoring**: Track certificate deployments across environments
- **Compliance Reporting**: Maintain records of SSL certificate status

### Security Monitoring
- **Threat Detection**: Forward Active Protect alerts to security systems
- **Incident Response**: Trigger automated responses to security events
- **Audit Logging**: Track all security-related activities

### Access Control
- **Access Monitoring**: Track who accesses your servers
- **OAuth Management**: Monitor application authorizations
- **Security Compliance**: Maintain audit trails for access events

## Response Strategies

### Automated Security Responses
```json
// Example: Auto-block aggressive IPs
{
  "event_type": "active.protect.block",
  "fail2ban_action": {
    "attack": "SSH",
    "address": "1.2.3.4"
  }
  // → Trigger: Add to firewall blacklist
}
```

### Certificate Management
```json
// Example: Certificate expiring soon
{
  "event_type": "ssl_certificate.expire.soon",
  "ssl_certificate": {
    "server_names": "api.example.com",
    "cert_expiry": "2024-07-01T00:00:00Z"
  }
  // → Trigger: Automatic renewal process
}
```

<Callout type="warning" title="Security Event Priority">
Security events often require immediate attention. Consider setting up high-priority alerting for Active Protect blocks and SSL certificate issues.
</Callout>

<RelatedModels models={['SslCertificate', 'User', 'Stack', 'Server']} />
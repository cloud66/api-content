---
title: "Update Queue Task Status"
scope: "redeploy"
path: "/queues/:id"
method: "PUT"
request_body: |
  {
    "task_uuid": "task-uuid-here",
    "state": "success",
    "run_result": "Task completed successfully",
    "host_name": "agent-hostname",
    "session_id": "session-id-for-logging"
  }
response: |
  {
    "ok": true
  }
parameters:
  - name: id
    in: path
    required: true
    type: string
    description: "Queue identifier (not used in current implementation)"
  - name: task_uuid
    in: body
    required: true
    type: string
    description: "UUID of the task to update"
  - name: state
    in: body
    required: true
    type: string
    description: "Task state. Valid values: 'success', 'fail', 'ack'"
  - name: run_result
    in: body
    required: false
    type: string
    description: "Result message or output from task execution"
  - name: host_name
    in: body
    required: true
    type: string
    description: "Host name of the agent reporting the status"
  - name: session_id
    in: body
    required: false
    type: string
    description: "Session ID for tracking logs in Halo"
---

# Update Queue Task Status

Reports back on the status of a task that was picked up from a queue. This endpoint is used by agents to communicate task completion, failure, or acknowledgment back to Cloud66.

## Task States

### success
Indicates the task completed successfully:
- Updates task status to success
- Stores the run result and session ID
- Marks the task as complete

### fail  
Indicates the task failed:
- Updates task status to failed
- Stores the error message and session ID
- Marks the task as failed for retry or manual intervention

### ack
Acknowledges task pickup without completion:
- Updates task runtime with agent UUID and session ID
- Indicates the agent is working on the task
- Does not change completion status

## Agent Management

The endpoint automatically:
1. **Updates Agent**: Finds or creates the agent by host name
2. **Pulse Update**: Updates the agent's last activity timestamp
3. **Task Validation**: Verifies the task belongs to the authenticated account

## Error Conditions

<ResponseCodes 
  codes={[400, 404]} 
  overrides={{
    400: [
      "Invalid state - State must be 'success', 'fail', or 'ack'"
    ],
    404: [
      "Invalid task - Task UUID not found or doesn't belong to authenticated account"
    ]
  }}
/>

<Callout type="info" title="Session Tracking">
The optional `session_id` parameter is used for log tracking in the Halo logging system, allowing correlation of task execution with detailed logs.
</Callout>

<RelatedModels models={['AsyncAction']} />